"0","#| label: data-setup"
"0","#| echo: false"
"0","#| massage: false"
"0","#| warning: false"
"0","#| output: false"
"0",""
"0",""
"0","# import libraries"
"0","library(WDI); library(tidyverse); library(janitor); library(countrycode); library(ggplot2)"
"0",""
"0","# pull the data"
"0","migration_raw <- WDI("
"0","  country  = ""all"","
"0","  indicator = c("
"0","    migrants_total = ""SM.POP.TOTL"","
"0","    migrants_pct   = ""SM.POP.TOTL.ZS"""
"0","  ),"
"0","  start = 2020, end = 2020, extra = TRUE"
"0",")"
"0"," "
"0","migration <- migration_raw %>%"
"0","  clean_names() %>%"
"0","  filter(region != ""Aggregates"") %>%"
"0","  mutate(continent = countrycode(iso3c, ""iso3c"", ""continent""))"
"0",""
"0","# population (2020) for width"
"0","pop2020 <- WDI(""all"", ""SP.POP.TOTL"", start = 2020, end = 2020, extra = TRUE) |>"
"0","  janitor::clean_names() |>"
"0","  dplyr::select(iso3c, sp_pop_totl)"
"0"," "
"0","# join to add population"
"0","df <- migration |>"
"0","  dplyr::select(iso3c, country, migrants_total, migrants_pct) |>"
"0","  dplyr::left_join(pop2020, by = ""iso3c"") |>"
"0","  dplyr::filter(!is.na(migrants_pct), !is.na(sp_pop_totl))"
