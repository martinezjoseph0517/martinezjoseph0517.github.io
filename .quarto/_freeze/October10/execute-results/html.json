{
  "hash": "b0032bf2e8517b2a83ff462599fd90ca",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"October 10th, 2025\"\nformat: \n  html:\n    theme: lux\n    css: styles.css\n   \nexecute:\n  echo: true\n  warning: false\n  message: false\n---\n\n**Assignment 4**\n\n**Chart 1 - Variable-Width Column Chart** **of Migrant share of population (%)**\n\n\n::: {.cell massage='false'}\n\n:::\n\n\n\n::: {.cell massage='false'}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(scales)\nlibrary(dplyr)\n\n\n# Set up properties for the chart\nvw8 <- df |>\n  dplyr::slice_max(order_by = migrants_total, n = 8) |>\n  dplyr::mutate(\n    width_scaled = scales::rescale(sp_pop_totl, to = c(0.4, 1.0))  # keep small bars visible\n  ) |>\n  dplyr::arrange(dplyr::desc(migrants_pct)) |>\n  dplyr::rename(\n    `Abbr` = iso3c,\n    `Total Migrants` = migrants_total,\n    `% Migrants` = migrants_pct,\n    `Total Population` = sp_pop_totl\n  )\nvw8\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Abbr            country Total Migrants % Migrants Total Population\n1  SAU       Saudi Arabia       13071258       42.2         31552510\n2  AUS          Australia        7604850       29.5         25649248\n3  CAN             Canada        8332892       21.8         38028638\n4  DEU            Germany       15021300       18.0         83160871\n5  GBR     United Kingdom       10520870       15.6         66744000\n6  USA      United States       50471028       14.9        331577720\n7  FRA             France        8610719       13.1         67601110\n8  RUS Russian Federation        7297611        5.0        145245148\n  width_scaled\n1    0.4115777\n2    0.4000000\n3    0.4242790\n4    0.5127943\n5    0.4805968\n6    1.0000000\n7    0.4822778\n8    0.6345566\n```\n\n\n:::\n\n```{.r .cell-code}\n# Create Variable Width Column Chart\np_vw <- ggplot(vw8, aes(x = reorder(country, `% Migrants`),\n                        y = `% Migrants`)) +\n  geom_col(aes(width = width_scaled), fill = \"#54A24B\") +\n  # Create the chart\n  scale_y_continuous(labels = label_number(accuracy = 0.1)) +\n  labs(\n    title = \"Migrant % vs. Total Population (2020)\",\n    subtitle = \"Height = Migrant share of population (%); Width = Total population\",\n    x = NULL,\n    y = \"Migrant share of population (%)\"\n  ) +\n  theme_minimal(base_family = \"serif\") +\n  theme(\n    plot.title.position = \"plot\",\n    panel.grid.minor = element_blank(),\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 8)\n  )\n\np_vw\n```\n\n::: {.cell-output-display}\n![Variable-Width Column Chart](October10_files/figure-html/plot-vw-1.png){width=672}\n:::\n:::\n\n\n**Chart 2 - Table of** **Migrant Population by Country (2020)**\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-71bc6542b39729e632cb\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-71bc6542b39729e632cb\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>Table 1 — Migrant Population by Country (2020)<\\/caption>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\",\"194\",\"195\",\"196\",\"197\",\"198\",\"199\",\"200\",\"201\",\"202\",\"203\",\"204\",\"205\",\"206\",\"207\",\"208\",\"209\",\"210\",\"211\",\"212\",\"213\",\"214\"],[\"Afghanistan\",\"Albania\",\"Algeria\",\"American Samoa\",\"Andorra\",\"Angola\",\"Antigua and Barbuda\",\"Argentina\",\"Armenia\",\"Aruba\",\"Australia\",\"Austria\",\"Azerbaijan\",\"Bahamas, The\",\"Bahrain\",\"Bangladesh\",\"Barbados\",\"Belarus\",\"Belgium\",\"Belize\",\"Benin\",\"Bermuda\",\"Bhutan\",\"Bolivia\",\"Bosnia and Herzegovina\",\"Botswana\",\"Brazil\",\"British Virgin Islands\",\"Brunei Darussalam\",\"Bulgaria\",\"Burkina Faso\",\"Burundi\",\"Cabo Verde\",\"Cambodia\",\"Cameroon\",\"Canada\",\"Cayman Islands\",\"Central African Republic\",\"Chad\",\"Channel Islands\",\"Chile\",\"China\",\"Colombia\",\"Comoros\",\"Congo, Dem. Rep.\",\"Congo, Rep.\",\"Costa Rica\",\"Cote d'Ivoire\",\"Croatia\",\"Cuba\",\"Curacao\",\"Cyprus\",\"Czechia\",\"Denmark\",\"Djibouti\",\"Dominica\",\"Dominican Republic\",\"Ecuador\",\"Egypt, Arab Rep.\",\"El Salvador\",\"Equatorial Guinea\",\"Eritrea\",\"Estonia\",\"Eswatini\",\"Ethiopia\",\"Faroe Islands\",\"Fiji\",\"Finland\",\"France\",\"French Polynesia\",\"Gabon\",\"Gambia, The\",\"Georgia\",\"Germany\",\"Ghana\",\"Gibraltar\",\"Greece\",\"Greenland\",\"Grenada\",\"Guam\",\"Guatemala\",\"Guinea\",\"Guinea-Bissau\",\"Guyana\",\"Haiti\",\"Honduras\",\"Hong Kong SAR, China\",\"Hungary\",\"Iceland\",\"India\",\"Indonesia\",\"Iran, Islamic Rep.\",\"Iraq\",\"Ireland\",\"Isle of Man\",\"Israel\",\"Italy\",\"Jamaica\",\"Japan\",\"Jordan\",\"Kazakhstan\",\"Kenya\",\"Kiribati\",\"Korea, Dem. People's Rep.\",\"Korea, Rep.\",\"Kuwait\",\"Kyrgyz Republic\",\"Lao PDR\",\"Latvia\",\"Lebanon\",\"Lesotho\",\"Liberia\",\"Libya\",\"Liechtenstein\",\"Lithuania\",\"Luxembourg\",\"Macao SAR, China\",\"Madagascar\",\"Malawi\",\"Malaysia\",\"Maldives\",\"Mali\",\"Malta\",\"Marshall Islands\",\"Mauritania\",\"Mauritius\",\"Mexico\",\"Micronesia, Fed. Sts.\",\"Moldova\",\"Monaco\",\"Mongolia\",\"Montenegro\",\"Morocco\",\"Mozambique\",\"Myanmar\",\"Namibia\",\"Nauru\",\"Nepal\",\"Netherlands\",\"New Caledonia\",\"New Zealand\",\"Nicaragua\",\"Niger\",\"Nigeria\",\"North Macedonia\",\"Northern Mariana Islands\",\"Norway\",\"Oman\",\"Pakistan\",\"Palau\",\"Panama\",\"Papua New Guinea\",\"Paraguay\",\"Peru\",\"Philippines\",\"Poland\",\"Portugal\",\"Qatar\",\"Romania\",\"Russian Federation\",\"Rwanda\",\"Samoa\",\"San Marino\",\"Sao Tome and Principe\",\"Saudi Arabia\",\"Senegal\",\"Serbia\",\"Seychelles\",\"Sierra Leone\",\"Singapore\",\"Sint Maarten (Dutch part)\",\"Slovak Republic\",\"Slovenia\",\"Solomon Islands\",\"South Africa\",\"South Sudan\",\"Spain\",\"Sri Lanka\",\"St. Kitts and Nevis\",\"St. Lucia\",\"St. Martin (French part)\",\"St. Vincent and the Grenadines\",\"Sudan\",\"Suriname\",\"Sweden\",\"Switzerland\",\"Syrian Arab Republic\",\"Tajikistan\",\"Tanzania\",\"Thailand\",\"Timor-Leste\",\"Togo\",\"Tonga\",\"Trinidad and Tobago\",\"Tunisia\",\"Turkiye\",\"Turkmenistan\",\"Turks and Caicos Islands\",\"Tuvalu\",\"Uganda\",\"Ukraine\",\"United Arab Emirates\",\"United Kingdom\",\"United States\",\"Uruguay\",\"Uzbekistan\",\"Vanuatu\",\"Venezuela, RB\",\"Viet Nam\",\"Virgin Islands (U.S.)\",\"West Bank and Gaza\",\"Yemen, Rep.\",\"Zambia\",\"Zimbabwe\"],[\"Asia\",\"Europe\",\"Africa\",\"Oceania\",\"Europe\",\"Africa\",\"Americas\",\"Americas\",\"Asia\",\"Americas\",\"Oceania\",\"Europe\",\"Asia\",\"Americas\",\"Asia\",\"Asia\",\"Americas\",\"Europe\",\"Europe\",\"Americas\",\"Africa\",\"Americas\",\"Asia\",\"Americas\",\"Europe\",\"Africa\",\"Americas\",\"Americas\",\"Asia\",\"Europe\",\"Africa\",\"Africa\",\"Africa\",\"Asia\",\"Africa\",\"Americas\",\"Americas\",\"Africa\",\"Africa\",null,\"Americas\",\"Asia\",\"Americas\",\"Africa\",\"Africa\",\"Africa\",\"Americas\",\"Africa\",\"Europe\",\"Americas\",\"Americas\",\"Asia\",\"Europe\",\"Europe\",\"Africa\",\"Americas\",\"Americas\",\"Americas\",\"Africa\",\"Americas\",\"Africa\",\"Africa\",\"Europe\",\"Africa\",\"Africa\",\"Europe\",\"Oceania\",\"Europe\",\"Europe\",\"Oceania\",\"Africa\",\"Africa\",\"Asia\",\"Europe\",\"Africa\",\"Europe\",\"Europe\",\"Americas\",\"Americas\",\"Oceania\",\"Americas\",\"Africa\",\"Africa\",\"Americas\",\"Americas\",\"Americas\",\"Asia\",\"Europe\",\"Europe\",\"Asia\",\"Asia\",\"Asia\",\"Asia\",\"Europe\",\"Europe\",\"Asia\",\"Europe\",\"Americas\",\"Asia\",\"Asia\",\"Asia\",\"Africa\",\"Oceania\",\"Asia\",\"Asia\",\"Asia\",\"Asia\",\"Asia\",\"Europe\",\"Asia\",\"Africa\",\"Africa\",\"Africa\",\"Europe\",\"Europe\",\"Europe\",\"Asia\",\"Africa\",\"Africa\",\"Asia\",\"Asia\",\"Africa\",\"Europe\",\"Oceania\",\"Africa\",\"Africa\",\"Americas\",\"Oceania\",\"Europe\",\"Europe\",\"Asia\",\"Europe\",\"Africa\",\"Africa\",\"Asia\",\"Africa\",\"Oceania\",\"Asia\",\"Europe\",\"Oceania\",\"Oceania\",\"Americas\",\"Africa\",\"Africa\",\"Europe\",\"Oceania\",\"Europe\",\"Asia\",\"Asia\",\"Oceania\",\"Americas\",\"Oceania\",\"Americas\",\"Americas\",\"Asia\",\"Europe\",\"Europe\",\"Asia\",\"Europe\",\"Europe\",\"Africa\",\"Oceania\",\"Europe\",\"Africa\",\"Asia\",\"Africa\",\"Europe\",\"Africa\",\"Africa\",\"Asia\",\"Americas\",\"Europe\",\"Europe\",\"Oceania\",\"Africa\",\"Africa\",\"Europe\",\"Asia\",\"Americas\",\"Americas\",\"Americas\",\"Americas\",\"Africa\",\"Americas\",\"Europe\",\"Europe\",\"Asia\",\"Asia\",\"Africa\",\"Asia\",\"Asia\",\"Africa\",\"Oceania\",\"Americas\",\"Africa\",\"Asia\",\"Asia\",\"Americas\",\"Oceania\",\"Africa\",\"Europe\",\"Asia\",\"Europe\",\"Americas\",\"Americas\",\"Asia\",\"Oceania\",\"Americas\",\"Asia\",\"Americas\",\"Asia\",\"Asia\",\"Africa\",\"Africa\"],[144098,48810,250378,23608,45574,656434,29386,1912294,207139,53593,7604850,1781046,198894,63583,785983,2115408,34869,1067090,2046975,62043,394276,19739,53612,164121,36042,110268,1048866,22164,111959,184363,723989,344767,15788,79341,579209,8332892,29242,88546,547494,84087,1476240,1415116,1932807,12496,952871,387606,520729,2760255,528056,3024,57210,190366,680221,718856,119738,8284,603794,721560,602472,42767,230618,13934,199277,32858,875170,6812,14087,386052,8610719,30081,416651,215659,79368,15021300,476412,11190,1340456,5899,7213,80472,84311,121437,17945,31169,18884,39195,2962492,584567,65424,4929816,306702,2797235,365766,951686,43040,2068830,6223851,23629,3289042,4940142,1990268,1050147,3126,49549,1723389,3030731,199011,48731,239422,1586346,12060,87947,826537,25877,145184,298062,403490,35563,191362,3718696,70079,485829,114760,3298,182286,28893,1335154,2832,77291,26601,21345,70999,102358,338850,76446,109391,2201,487564,2425521,73141,1343900,42167,348056,1308568,131311,21843,852238,1766142,3276580,5088,313165,31068,169567,1184762,87212,738099,1001963,2182000,338734,7297611,513907,4021,5543,2139,13071258,274929,733091,13050,53746,2589107,28845,197161,277964,2520,2639076,882252,7146130,40254,7725,8338,null,4738,1379147,47801,2033902,2610189,868711,276031,426017,3015007,8399,279936,3742,78849,60145,6580295,194920,25748,239,1776038,4997387,7184000,10520870,50471028,108267,1162007,3257,1324193,200639,56753,272784,387113,187955,416141],[0.4,1.7,0.6,47.4,58.9,2,32,4.2,7.2,49.9,29.5,20,2,16.1,53,1.3,12.4,11.4,17.7,15.9,3,30.7,7,1.4,1.1,4.7,0.5,59.7,25,2.7,3.4,2.7,3.1,0.5,2.2,21.8,42.6,1.8,3.2,50.6,7.6,0.1,3.8,1.6,1,6.7,10.3,9.5,13.4,0,30.9,14.6,6.4,12.3,10.8,12.3,5.5,4.1,0.6,0.7,13.4,0.4,15,2.8,0.7,13,1.5,7,13.1,10.8,17.9,8.6,2.1,18,1.5,30.9,12.5,10.5,6.2,49.6,0.5,0.9,0.9,3.9,0.2,0.4,39.6,6,17.8,0.4,0.1,3.2,0.9,19.1,51.2,23.5,10.4,0.8,2.6,45.5,10.2,2,2.5,0.2,3.3,68.90000000000001,3,0.7,12.6,27.8,0.5,1.7,11.7,66.8,5.2,47.3,59.1,0.1,1,11,14,2.2,22.1,7.7,4,2.3,1.1,2.6,2.5,69.90000000000001,0.6,11.7,0.3,1.1,0.1,4,18.9,1.7,13.8,25.7,26.5,0.6,1.5,0.6,7,46,15.8,39.1,1.4,28.6,7.3,0.3,2.6,3.6,0.1,1.9,9.699999999999999,77.8,1.7,5,3.9,1.9,15.9,1,42.2,1.6,10.6,10.8,0.7,46.1,70.3,3.6,13.2,0.3,4.4,8.199999999999999,15,0.2,16.5,4.7,0,4.6,2.9,7.8,19.6,30.2,4.1,2.8,0.7,4.2,0.6,3.2,3.5,5.3,0.5,7.6,2.8,58,2.3,4,11.2,76,15.6,14.9,3.2,3.5,1.1,4.7,0.2,64.7,5.4,1.1,1,2.7],[39068979,2837849,44042091,49761,77380,33451132,91846,45191965,2961500,108587,25649248,8916864,10093121,395863,1472204,166298024,281698,9379952,11538604,390812,13070169,64382,770006,11816299,3299349,2365894,208660842,37135,447404,6550696,21478690,12617036,514679,16725474,26210558,38028638,68684,5026628,17224679,166235,19370624,1411100000,50629997,802163,95989998,5752791,5034320,28915449,3914206,11176354,154947,1302247,10697858,5831404,1105188,67573,11008300,17546065,109315124,6234673,1716468,3291271,1329522,1192729,118917671,52567,914963,5529543,67601110,279209,2322539,2515733,3722716,83160871,31887809,36173,10698599,56367,116341,162158,17357325,13371183,2013255,807481,11243848,10119640,7481000,9670419,366463,1402617695,274814866,87723443,42116605,5039747,84064,9215100,59438851,2830739,126261000,10865228,19482117,52217334,126099,26136312,51836239,4400267,6726596,7346533,1900449,5702398,2235727,5149463,7045399,38901,2810369,630419,685400,28953556,19533888,33889558,502118,21713836,515490,42706,4600131,1266014,126799054,110916,2635130,38050,3327204,626590,36584208,30783688,53016522,2728762,11643,28966574,17441500,284176,5090200,6565267,23717613,213996181,1856124,47528,5379475,4522497,235001746,17792,4293261,9815746,6603739,32838579,112081264,37515748,10297081,2794148,19265250,145245148,13065837,211944,34770,217435,31552510,16789219,6899126,98462,7912558,5685807,41008,5458827,2102419,744498,60562381,10698467,47359424,21919000,46870,178250,31786,103526,46789231,612317,10353442,8638167,21049429,9749310,60972798,71641484,1326053,8669720,105704,1366725,11974057,83384680,6949912,44386,10399,44457152,44680014,9401038,66744000,331577720,3398968,33586372,298858,28444077,98079191,106290,4803269,36134863,19059395,15526888]],\"container\":\"<table class=\\\"cell-border stripe hover\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Country<\\/th>\\n      <th>Continent<\\/th>\\n      <th>Total Migrants<\\/th>\\n      <th>% of Population Migrants<\\/th>\\n      <th>Total Population (2020)<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":20,\"scrollX\":true,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4,5]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Country\",\"targets\":1},{\"name\":\"Continent\",\"targets\":2},{\"name\":\"Total Migrants\",\"targets\":3},{\"name\":\"% of Population Migrants\",\"targets\":4},{\"name\":\"Total Population (2020)\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[10,20,25,50,100],\"rowCallback\":\"function(row, data, displayNum, displayIndex, dataIndex) {\\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'color':'black','background-color':'white'});\\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'color':'black','background-color':'white'});\\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'color':'black','background-color':'white'});\\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'color':'black','background-color':'white'});\\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'color':'black','background-color':'white'});\\n}\"}},\"evals\":[\"options.rowCallback\"],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n**Chart 3 - Bar Charts of** **Global Migration Overview (2020)**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# To create this chart I took inspiration from analyst ___. I used their use of viridis as basis for this code.\n# I took the basis, used patchwork to post both charts side by side & used ChatGPT & forum.posit.co for guidance\n# to solve specific syntax errors.\n\nlibrary(WDI)\nlibrary(tidyverse)\nlibrary(viridis)\nlibrary(janitor)\nlibrary(countrycode)\nlibrary(ggplot2)\nlibrary(scales)\nlibrary(patchwork)\n\n#DATA\n# 2020 snapshot: migrants (count + %s) for all countries\nmigration_raw <- WDI(\n  country  = \"all\",\n  indicator = c(\n    migrants_total = \"SM.POP.TOTL\",\n    migrants_pct   = \"SM.POP.TOTL.ZS\"\n  ),\n  start = 2020, end = 2020, extra = TRUE\n)\n\nmigration <- migration_raw %>%\n  clean_names() %>%\n  filter(region != \"Aggregates\") %>% # remove World/income groups\n  mutate(continent = countrycode(iso3c, \"iso3c\", \"continent\"))\n\n\n# Summarize by continent (2020)\n\n  continent_summary <- migration %>%\n  group_by(continent) %>%\n  summarize(\n    avg_migrant_pct = mean(migrants_pct, na.rm = TRUE),\n    total_migrants = sum(migrants_total, na.rm = TRUE)\n  ) %>%\n  arrange(desc(total_migrants))\n  \n  continent_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 3\n  continent avg_migrant_pct total_migrants\n  <chr>               <dbl>          <dbl>\n1 Asia                14.9        83609413\n2 Europe              17.1        82887317\n3 Americas            14.6        72556607\n4 Africa               3.45       24959596\n5 Oceania             16.1         9253374\n6 <NA>                50.6           84087\n```\n\n\n:::\n\n```{.r .cell-code}\n# Create dataset\n# Average migrant % per continent (2020)\ncontinent_summary_avg <- migration %>%\n  group_by(continent) %>%\n  summarize(avg_migrant_pct = mean(migrants_pct, na.rm = TRUE)) %>%\n  arrange(desc(avg_migrant_pct))\n\ncontinent_summary_avg\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n  continent avg_migrant_pct\n  <chr>               <dbl>\n1 <NA>                50.6 \n2 Europe              17.1 \n3 Oceania             16.1 \n4 Asia                14.9 \n5 Americas            14.6 \n6 Africa               3.45\n```\n\n\n:::\n\n```{.r .cell-code}\n# Replace NA with \"N/A\"\ncontinent_summary$continent <- ifelse(\n  is.na(continent_summary$continent),\n  \"N/A\",\n  continent_summary$continent\n)\n\n# Convert to factor with alphabetical levels\ncontinent_summary$continent <- factor(\n  continent_summary$continent,\n  levels = sort(unique(continent_summary$continent))\n)\n\ncontinent_levels <- c(setdiff(sort(unique(continent_summary$continent)), \"N/A\"), \"N/A\")\ncontinent_summary$continent <- factor(continent_summary$continent, levels = continent_levels)\n\n\n# Graph 1 Average Migrant %\np1 <- ggplot(continent_summary, aes(x = continent, y = avg_migrant_pct, fill = continent)) +\n  geom_col(width = 0.7) +\n  geom_text(aes(label = paste0(round(avg_migrant_pct, 1), \"%\")),\n            vjust = -0.5, size = 4) +\n  scale_fill_viridis(discrete = TRUE, option = \"E\") +\n  labs(\n    title = \"Average Migrant Percentage by Continent\",\n    x = \"\",\n    y = \"Average % of Population\"\n  ) +\n  ylim(0, 100) +\n  theme_minimal(base_size = 12) +\n  theme(\n        legend.position = \"none\",\n        plot.title = element_text(size = 10, face = \"bold\")\n        )\n\n\n\n#Graph 2 Total Migrants\np2 <- ggplot(continent_summary, aes(x = continent, y = total_migrants / 1e6, fill = continent)) +\n  geom_col(width = 0.7) +\n  geom_text(aes(label = paste0(round(total_migrants / 1e6, 1), \"M\")),\n            vjust = -0.5, size = 4) +\n  scale_fill_viridis(discrete = TRUE, option = \"E\") +\n  scale_y_continuous(limits = c(0, 90), breaks = seq(0, 90, 10)) +\n  labs(\n    title = \"Total Migrant Population by Continent\",\n    x = \"\",\n    y = \"Total Migrants (millions)\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n        legend.position = \"none\",\n        plot.title = element_text(size = 10, face = \"bold\")\n        )\n\n#Final Product\nprint((p1 + p2) + plot_annotation(title = \"Global Migration Overview (2020)\"))\n```\n\n::: {.cell-output-display}\n![](October10_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n**Chart 4 - Column Chart of** **Top 8 Countries by International Migrant Stock (2020)**\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(dplyr.summarise.inform = FALSE)\n\nsuppressPackageStartupMessages({\n  library(WDI)\n  library(tidyverse, warn.conflicts = FALSE)  # stops “masked from …” notes\n  library(janitor)\n  library(countrycode)\n  library(ggplot2)\n  library(scales)\n})\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmigration_raw <- WDI(\n  country = \"all\",\n  indicator = c(\n    migrants_total = \"SM.POP.TOTL\",     # international migrants (count)\n    migrants_pct   = \"SM.POP.TOTL.ZS\"   # migrants as % of population\n  ),\n  start = 2020, end = 2020, extra = TRUE\n)\n\nmigration <- migration_raw |>\n  clean_names() |>\n  filter(region != \"Aggregates\") |>\n  mutate(continent = countrycode(iso3c, \"iso3c\", \"continent\"))\n\n# Top 8 destinations by migrant COUNT\ntop8 <- migration |>\n  filter(!is.na(migrants_total)) |>\n  slice_max(order_by = migrants_total, n = 8) |>\n  arrange(migrants_total) |>         # smallest → largest so bars rise L→R\n  mutate(country = factor(country, levels = country))\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlight_green <- \"#8BC34A\"\n\np_top8_v <- ggplot(top8, aes(x = country, y = migrants_total)) +\n  geom_col(fill = light_green) +\n  scale_y_continuous(\n    labels = label_number(scale_cut = cut_short_scale()),\n    expand = expansion(mult = c(0, 0.03))\n  ) +\n  labs(\n    title = \"Top 8 Countries by International Migrant Stock (2020)\",\n    subtitle = \"Source: World Bank WDI (SM.POP.TOTL)\",\n    x = NULL, y = \"Migrant Stock (people)\"\n  ) +\n  theme_minimal(base_family = \"serif\") +\n  theme(plot.title.position = \"plot\",\n        panel.grid.minor = element_blank(),\n        axis.text.x = element_text(angle = 45, hjust = 1))\n\np_top8_v\n```\n\n::: {.cell-output-display}\n![](October10_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!dir.exists(\"figures\")) dir.create(\"figures\")\nggsave(\"figures/tanmoy_chart4_vertical_lightgreen.png\",\n       plot = p_top8_v, width = 10, height = 6, dpi = 300)\n```\n:::\n\n",
    "supporting": [
      "October10_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/datatables-binding-0.34.0/datatables.js\"></script>\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.2/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.2/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}